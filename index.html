<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgriStore - Premium Agricultural Products</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                    },
                    colors: {
                        agri: {
                            green: '#10b981',
                            dark: '#064e3b',
                            light: '#d1fae5',
                            accent: '#f59e0b',
                        }
                    },
                    animation: {
                        'fade-in-up': 'fadeInUp 0.5s ease-out forwards',
                        'slide-in-right': 'slideInRight 0.3s ease-out forwards',
                    },
                    keyframes: {
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        slideInRight: {
                            '0%': { transform: 'translateX(100%)' },
                            '100%': { transform: 'translateX(0)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Outfit', sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .cart-open {
            overflow: hidden;
        }

        #cart-sidebar {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
    </style>
</head>

<body class="bg-stone-50 text-stone-900 dark:bg-stone-950 dark:text-stone-100 antialiased">

    <!-- Navbar -->
    <nav
        class="fixed top-0 left-0 right-0 bg-white/80 dark:bg-stone-900/80 backdrop-blur-md border-b border-stone-200 dark:border-stone-800 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center gap-2">
                    <div class="bg-agri-green p-2 rounded-lg text-white">
                        <i data-lucide="leaf" class="w-6 h-6"></i>
                    </div>
                    <span class="text-xl font-bold tracking-tight">Agri<span class="text-agri-green">Store</span></span>
                </div>

                <div class="flex items-center gap-4">
                    <button onclick="toggleDarkMode()"
                        class="p-2 hover:bg-stone-100 dark:hover:bg-stone-800 rounded-full transition-colors text-stone-600 dark:text-stone-400">
                        <i data-lucide="moon" id="dark-mode-icon" class="w-6 h-6"></i>
                    </button>
                    <button onclick="toggleCart()"
                        class="relative p-2 hover:bg-stone-100 dark:hover:bg-stone-800 rounded-full transition-colors">
                        <i data-lucide="shopping-cart" class="w-6 h-6 text-stone-600 dark:text-stone-400"></i>
                        <span id="cart-badge"
                            class="hidden absolute -top-1 -right-1 bg-agri-accent text-white text-xs font-bold w-5 h-5 flex items-center justify-center rounded-full shadow-sm">0</span>
                    </button>

                    <!-- User Profile Section -->
                    <div id="user-section"
                        class="flex items-center gap-2 border-l border-stone-200 dark:border-stone-800 pl-4 ml-2">
                        <button id="login-btn" onclick="openAuthModal()"
                            class="bg-agri-green text-white px-5 py-2 rounded-xl text-sm font-bold hover:bg-agri-dark transition-all">
                            Login
                        </button>
                        <div id="user-profile" class="hidden relative group">
                            <button
                                class="flex items-center gap-2 p-1 rounded-full hover:bg-stone-100 dark:hover:bg-stone-800 transition-all">
                                <div class="w-8 h-8 rounded-full bg-agri-green flex items-center justify-center text-white font-bold text-sm"
                                    id="user-avatar-char">
                                    U
                                </div>
                                <i data-lucide="chevron-down" class="w-4 h-4 text-stone-400"></i>
                            </button>
                            <div
                                class="absolute right-0 mt-2 w-48 bg-white dark:bg-stone-900 border border-stone-100 dark:border-stone-800 rounded-2xl shadow-xl py-2 hidden group-hover:block animate-fade-in-up">
                                <div class="px-4 py-2 border-b border-stone-100 dark:border-stone-800 mb-1">
                                    <p class="text-xs text-stone-500">Welcome,</p>
                                    <p class="font-bold truncate" id="user-name-display">User</p>
                                </div>
                                <button onclick="openOrdersModal()"
                                    class="w-full text-left px-4 py-2 hover:bg-stone-50 dark:hover:bg-stone-800 text-sm flex items-center gap-2">
                                    <i data-lucide="package" class="w-4 h-4"></i> My Orders
                                </button>
                                <button onclick="openWishlistModal()"
                                    class="w-full text-left px-4 py-2 hover:bg-stone-50 dark:hover:bg-stone-800 text-sm flex items-center gap-2">
                                    <i data-lucide="heart" class="w-4 h-4"></i> Wishlist
                                </button>
                                <button onclick="handleLogout()"
                                    class="w-full text-left px-4 py-2 hover:bg-stone-50 dark:hover:bg-stone-800 text-sm flex items-center gap-2 text-red-500">
                                    <i data-lucide="log-out" class="w-4 h-4"></i> Logout
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Cart Sidebar -->
    <div id="cart-overlay" onclick="toggleCart()"
        class="fixed inset-0 bg-stone-900/50 backdrop-blur-sm z-[60] hidden opacity-0 transition-opacity duration-300">
    </div>
    <div id="cart-sidebar"
        class="fixed top-0 right-0 h-full w-full sm:w-96 bg-white dark:bg-stone-900 shadow-2xl z-[70] transform translate-x-full">
        <div class="flex flex-col h-full">
            <div class="p-6 border-b border-stone-200 dark:border-stone-800 flex justify-between items-center">
                <h2 class="text-xl font-bold">Your Cart</h2>
                <button onclick="toggleCart()" class="p-2 hover:bg-stone-100 dark:hover:bg-stone-800 rounded-full">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            <div id="cart-items" class="flex-1 overflow-y-auto p-6 space-y-4">
                <!-- Cart items injected here -->
                <div id="empty-cart-msg" class="text-center py-12 text-stone-500">
                    <i data-lucide="shopping-bag" class="w-12 h-12 mx-auto mb-4 opacity-20"></i>
                    <p>Your cart is empty</p>
                </div>
            </div>
            <div class="p-6 border-t border-stone-200 dark:border-stone-800 bg-stone-50 dark:bg-stone-900/50">
                <div class="flex justify-between items-center mb-4">
                    <span class="text-stone-500">Subtotal</span>
                    <span id="cart-total" class="text-2xl font-bold text-agri-green">₹0</span>
                </div>
                <button onclick="checkout()"
                    class="w-full bg-agri-green hover:bg-agri-dark text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-agri-green/20">
                    Proceed to Checkout
                </button>
            </div>
        </div>
    </div>

    <!-- Hero Section -->
    <div class="relative pt-24 pb-16 lg:pt-32 lg:pb-24 overflow-hidden">
        <div
            class="absolute top-0 right-0 -z-10 w-1/2 h-full bg-agri-light/30 dark:bg-agri-green/10 rounded-bl-[100px]">
        </div>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center lg:text-left lg:grid lg:grid-cols-2 lg:gap-12 items-center">
                <div class="animate-fade-in-up">
                    <div
                        class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-agri-light dark:bg-agri-green/20 text-agri-dark dark:text-agri-light text-sm font-medium mb-6">
                        <span class="relative flex h-2 w-2">
                            <span
                                class="animate-ping absolute inline-flex h-full w-full rounded-full bg-agri-green opacity-75"></span>
                            <span class="relative inline-flex rounded-full h-2 w-2 bg-agri-green"></span>
                        </span>
                        New Harvest Season 2026
                    </div>
                    <h1 class="text-5xl lg:text-6xl font-bold text-stone-900 dark:text-white tracking-tight mb-6">
                        Cultivate abundance with <span class="text-agri-green">premium inputs</span>
                    </h1>
                    <p class="text-xl text-stone-600 dark:text-stone-400 mb-8 leading-relaxed max-w-2xl">
                        Source high-quality seeds, fertilizers, and tools. Bringing modern agricultural solutions to
                        your doorstep.
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center lg:justify-start">
                        <a href="#products"
                            class="inline-flex items-center justify-center gap-2 bg-agri-green text-white px-8 py-3 rounded-xl font-semibold hover:bg-agri-dark transition-all shadow-lg shadow-agri-green/20">
                            Shop Now <i data-lucide="arrow-right" class="w-5 h-5"></i>
                        </a>
                        <button
                            class="inline-flex items-center justify-center gap-2 bg-white dark:bg-stone-800 text-stone-900 dark:text-white border border-stone-200 dark:border-stone-700 px-8 py-3 rounded-xl font-semibold hover:bg-stone-50 dark:hover:bg-stone-700 transition-all">
                            <i data-lucide="sprout" class="w-5 h-5"></i> Learn Growing
                        </button>
                    </div>
                </div>
                <div
                    class="hidden lg:block relative mt-12 lg:mt-0 opacity-0 animate-[fadeInUp_0.8s_ease-out_0.2s_forwards]">
                    <div class="absolute inset-0 bg-agri-green rounded-3xl rotate-3 opacity-20 blur-xl"></div>
                    <img src="https://images.unsplash.com/photo-1500382017468-9049fed747ef?auto=format&fit=crop&q=80&w=1000"
                        alt="Modern Agriculture Field"
                        class="relative rounded-3xl shadow-2xl rotate-3 hover:rotate-0 transition-all duration-700" />
                </div>
            </div>
        </div>
    </div>

    <!-- Search and Filters -->
    <section id="products"
        class="py-12 bg-white dark:bg-stone-900/50 sticky top-16 z-40 border-y border-stone-200 dark:border-stone-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col lg:flex-row gap-6 justify-between items-center">
                <div class="relative w-full lg:w-96">
                    <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-stone-400"></i>
                    <input type="text" id="search-input" oninput="handleFilter()" placeholder="Search products..."
                        class="w-full pl-10 pr-4 py-3 rounded-xl border border-stone-200 dark:border-stone-700 bg-white dark:bg-stone-800 focus:ring-2 focus:ring-agri-green outline-none transition-all">
                </div>
                <div class="flex flex-wrap items-center gap-2">
                    <button onclick="setCategory('All')"
                        class="category-btn active px-4 py-2 rounded-lg text-sm font-medium transition-all border border-transparent bg-agri-green text-white">All</button>
                    <button onclick="setCategory('Seeds')"
                        class="category-btn px-4 py-2 rounded-lg text-sm font-medium transition-all border border-stone-200 dark:border-stone-700 hover:border-agri-green">Seeds</button>
                    <button onclick="setCategory('Fertilizer')"
                        class="category-btn px-4 py-2 rounded-lg text-sm font-medium transition-all border border-stone-200 dark:border-stone-700 hover:border-agri-green">Fertilizer</button>
                    <button onclick="setCategory('Tools')"
                        class="category-btn px-4 py-2 rounded-lg text-sm font-medium transition-all border border-stone-200 dark:border-stone-700 hover:border-agri-green">Tools</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Grid -->
    <section class="py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Products will be injected here by JS -->
            </div>
            <div id="no-results" class="hidden text-center py-24">
                <i data-lucide="search-x" class="w-16 h-16 mx-auto mb-4 text-stone-300"></i>
                <h3 class="text-xl font-bold mb-2">No products found</h3>
                <p class="text-stone-500">Try adjusting your search or filters</p>
            </div>
        </div>
    </section>

    <!-- Product Modal -->
    <div id="product-modal" onclick="closeModal()"
        class="fixed inset-0 bg-stone-900/80 backdrop-blur-md z-[80] hidden opacity-0 transition-opacity duration-300 flex items-center justify-center p-4">
        <div onclick="event.stopPropagation()"
            class="bg-white dark:bg-stone-900 w-full max-w-4xl rounded-3xl overflow-hidden shadow-2xl relative">
            <button onclick="closeModal()"
                class="absolute top-4 right-4 p-2 bg-stone-100 dark:bg-stone-800 rounded-full hover:bg-stone-200 transition-colors z-10">
                <i data-lucide="x" class="w-6 h-6"></i>
            </button>
            <div class="grid lg:grid-cols-2">
                <div class="h-64 lg:h-full">
                    <img id="modal-img" src="" alt="" class="w-full h-full object-cover">
                </div>
                <div class="p-8 lg:p-12 flex flex-col justify-center">
                    <span id="modal-category"
                        class="bg-agri-light/50 dark:bg-agri-green/20 text-agri-dark dark:text-agri-light text-xs font-bold px-3 py-1 rounded-full w-fit mb-4"></span>
                    <div class="flex items-center gap-2 mb-4">
                        <div class="flex text-agri-accent">
                            <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                            <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                            <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                            <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                            <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                        </div>
                        <span id="modal-rating" class="text-xs text-stone-500 font-medium"></span>
                    </div>
                    <h2 id="modal-name" class="text-3xl font-bold mb-4"></h2>
                    <p id="modal-desc" class="text-stone-600 dark:text-stone-400 mb-6 leading-relaxed"></p>

                    <div class="grid grid-cols-3 gap-4 mb-8 pt-6 border-t border-stone-100 dark:border-stone-800">
                        <div class="text-center">
                            <p class="text-[10px] uppercase tracking-wider text-stone-400 font-bold mb-1">Weight</p>
                            <p id="spec-weight" class="text-sm font-bold"></p>
                        </div>
                        <div class="text-center border-x border-stone-100 dark:border-stone-800">
                            <p class="text-[10px] uppercase tracking-wider text-stone-400 font-bold mb-1">Brand</p>
                            <p id="spec-brand" class="text-sm font-bold"></p>
                        </div>
                        <div class="text-center">
                            <p class="text-[10px] uppercase tracking-wider text-stone-400 font-bold mb-1">Usage</p>
                            <p id="spec-usage" class="text-sm font-bold"></p>
                        </div>
                    </div>

                    <div
                        class="flex items-center justify-between mt-auto pt-6 border-t border-stone-100 dark:border-stone-800">
                        <span id="modal-price" class="text-3xl font-bold text-agri-green"></span>
                        <div class="flex items-center gap-3">
                            <button id="modal-add-btn"
                                class="bg-agri-green hover:bg-agri-dark text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg shadow-agri-green/20">
                                Add to Cart
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkout-modal" onclick="closeCheckout()"
        class="fixed inset-0 bg-stone-900/80 backdrop-blur-md z-[90] hidden opacity-0 transition-opacity duration-300 flex items-center justify-center p-4">
        <div onclick="event.stopPropagation()"
            class="bg-white dark:bg-stone-900 w-full max-w-lg rounded-3xl overflow-hidden shadow-2xl relative p-8">
            <button onclick="closeCheckout()"
                class="absolute top-4 right-4 p-2 hover:bg-stone-100 dark:hover:bg-stone-800 rounded-full transition-colors">
                <i data-lucide="x" class="w-6 h-6"></i>
            </button>
            <h2 class="text-2xl font-bold mb-6">Complete Your Order</h2>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-semibold mb-1">Full Name</label>
                    <input type="text" id="checkout-name"
                        class="w-full px-4 py-3 rounded-xl border border-stone-200 dark:border-stone-700 bg-stone-50 dark:bg-stone-800 focus:ring-2 focus:ring-agri-green outline-none"
                        placeholder="Enter your name">
                </div>
                <div>
                    <label class="block text-sm font-semibold mb-1">Phone Number</label>
                    <input type="tel" id="checkout-phone"
                        class="w-full px-4 py-3 rounded-xl border border-stone-200 dark:border-stone-700 bg-stone-50 dark:bg-stone-800 focus:ring-2 focus:ring-agri-green outline-none"
                        placeholder="e.g. +91 9876543210">
                </div>
                <div>
                    <label class="block text-sm font-semibold mb-1">Delivery Address</label>
                    <textarea id="checkout-address" rows="3"
                        class="w-full px-4 py-3 rounded-xl border border-stone-200 dark:border-stone-700 bg-stone-50 dark:bg-stone-800 focus:ring-2 focus:ring-agri-green outline-none"
                        placeholder="Street, City, Pincode"></textarea>
                </div>
                <div class="pt-4 border-t border-stone-100 dark:border-stone-800">
                    <label class="block text-sm font-semibold mb-2">Discount Coupon</label>
                    <div class="flex gap-2 mb-4">
                        <input type="text" id="coupon-input"
                            class="flex-1 px-4 py-2 rounded-xl border border-stone-200 dark:border-stone-700 bg-stone-50 dark:bg-stone-800 focus:ring-2 focus:ring-agri-green outline-none uppercase text-sm"
                            placeholder="Enter Code (e.g. AGRI10)">
                        <button onclick="applyCoupon()"
                            class="bg-stone-900 dark:bg-white text-white dark:text-stone-900 px-4 py-2 rounded-xl text-sm font-bold">
                            Apply
                        </button>
                    </div>
                    <div id="coupon-msg" class="text-xs mb-4 hidden"></div>
                </div>
                <div class="pt-4 border-t border-stone-100 dark:border-stone-800">
                    <div class="flex justify-between items-center mb-6">
                        <span class="text-stone-500 font-medium">Grand Total</span>
                        <span id="checkout-total" class="text-2xl font-bold text-agri-green">₹0</span>
                    </div>
                    <button onclick="confirmOrder()"
                        class="w-full bg-agri-green hover:bg-agri-dark text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-agri-green/20">
                        Confirm & Order via WhatsApp
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div id="auth-modal" onclick="closeAuthModal()"
        class="fixed inset-0 bg-stone-900/80 backdrop-blur-md z-[100] hidden opacity-0 transition-opacity duration-300 flex items-center justify-center p-4">
        <div onclick="event.stopPropagation()"
            class="bg-white dark:bg-stone-900 w-full max-w-md rounded-3xl overflow-hidden shadow-2xl relative p-8">
            <button onclick="closeAuthModal()"
                class="absolute top-4 right-4 p-2 hover:bg-stone-100 dark:hover:bg-stone-800 rounded-full transition-colors">
                <i data-lucide="x" class="w-6 h-6"></i>
            </button>

            <div id="login-form">
                <h2 class="text-3xl font-bold mb-2">Welcome Back</h2>
                <p class="text-stone-500 mb-8">Login to manage your orders</p>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold mb-1">Email Address</label>
                        <input type="email" id="login-email"
                            class="w-full px-4 py-3 rounded-xl border border-stone-200 dark:border-stone-700 bg-stone-50 dark:bg-stone-800 focus:ring-2 focus:ring-agri-green outline-none"
                            placeholder="name@example.com">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-1">Password</label>
                        <input type="password" id="login-password"
                            class="w-full px-4 py-3 rounded-xl border border-stone-200 dark:border-stone-700 bg-stone-50 dark:bg-stone-800 focus:ring-2 focus:ring-agri-green outline-none"
                            placeholder="••••••••">
                    </div>
                    <button onclick="handleLogin()"
                        class="w-full bg-agri-green hover:bg-agri-dark text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-agri-green/20">
                        Login
                    </button>
                    <p class="text-center text-sm text-stone-500">
                        Don't have an account?
                        <button onclick="toggleAuthMode('signup')" class="text-agri-green font-bold">Sign Up</button>
                    </p>
                </div>
            </div>

            <div id="signup-form" class="hidden">
                <h2 class="text-3xl font-bold mb-2">Join AgriStore</h2>
                <p class="text-stone-500 mb-8">Start your modern farming journey</p>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold mb-1">Full Name</label>
                        <input type="text" id="signup-name"
                            class="w-full px-4 py-3 rounded-xl border border-stone-200 dark:border-stone-700 bg-stone-50 dark:bg-stone-800 focus:ring-2 focus:ring-agri-green outline-none"
                            placeholder="Your Name">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-1">Email Address</label>
                        <input type="email" id="signup-email"
                            class="w-full px-4 py-3 rounded-xl border border-stone-200 dark:border-stone-700 bg-stone-50 dark:bg-stone-800 focus:ring-2 focus:ring-agri-green outline-none"
                            placeholder="name@example.com">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-1">Password</label>
                        <input type="password" id="signup-password"
                            class="w-full px-4 py-3 rounded-xl border border-stone-200 dark:border-stone-700 bg-stone-50 dark:bg-stone-800 focus:ring-2 focus:ring-agri-green outline-none"
                            placeholder="••••••••">
                    </div>
                    <button onclick="handleSignup()"
                        class="w-full bg-agri-green hover:bg-agri-dark text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-agri-green/20">
                        Create Account
                    </button>
                    <p class="text-center text-sm text-stone-500">
                        Already have an account?
                        <button onclick="toggleAuthMode('login')" class="text-agri-green font-bold">Login</button>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Tip Modal -->
    <div id="tip-modal" onclick="closeTipModal()"
        class="fixed inset-0 bg-stone-900/80 backdrop-blur-md z-[100] hidden opacity-0 transition-opacity duration-300 flex items-center justify-center p-4">
        <div onclick="event.stopPropagation()"
            class="bg-white dark:bg-stone-900 w-full max-w-2xl rounded-3xl overflow-hidden shadow-2xl relative p-8">
            <button onclick="closeTipModal()"
                class="absolute top-4 right-4 p-2 hover:bg-stone-100 dark:hover:bg-stone-800 rounded-full transition-colors">
                <i data-lucide="x" class="w-6 h-6"></i>
            </button>
            <div class="flex items-center gap-6 mb-8">
                <div id="tip-modal-icon"
                    class="w-20 h-20 bg-agri-light dark:bg-agri-green/20 rounded-2xl flex items-center justify-center text-agri-green">
                </div>
                <div>
                    <h2 id="tip-modal-title" class="text-3xl font-bold"></h2>
                    <p class="text-agri-green font-bold text-sm uppercase tracking-wider mt-1">Farming Guide</p>
                </div>
            </div>
            <div class="prose dark:prose-invert max-w-none">
                <p id="tip-modal-content" class="text-stone-600 dark:text-stone-400 text-lg leading-relaxed"></p>
            </div>
            <div class="mt-12 flex justify-end">
                <button onclick="closeTipModal()"
                    class="bg-stone-900 dark:bg-white text-white dark:text-stone-900 px-8 py-3 rounded-xl font-bold">
                    Got it, Thanks!
                </button>
            </div>
        </div>
    </div>

    <!-- Contact Section -->
    <section class="py-24 bg-stone-100 dark:bg-stone-900/30">
        <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h2 class="text-4xl font-bold text-stone-900 dark:text-white mb-6">Expert Farming Advice</h2>
            <p class="text-lg text-stone-500 dark:text-stone-400 mb-12">Connect with our agricultural specialists on
                WhatsApp for personalized recommendations and bulk orders.</p>

            <div
                class="bg-white dark:bg-stone-800 p-8 lg:p-10 rounded-[2rem] shadow-xl shadow-stone-200/50 dark:shadow-none border border-stone-200 dark:border-stone-700">
                <div class="space-y-6 text-left">
                    <div class="grid sm:grid-cols-2 gap-6">
                        <div>
                            <label for="name"
                                class="block text-sm font-semibold text-stone-700 dark:text-stone-300 mb-2">Full
                                Name</label>
                            <input type="text" id="name"
                                class="w-full px-5 py-3 rounded-xl border border-stone-200 dark:border-stone-600 bg-stone-50 dark:bg-stone-900 focus:ring-2 focus:ring-agri-green outline-none transition-all"
                                placeholder="Enter your name">
                        </div>
                        <div>
                            <label for="subject"
                                class="block text-sm font-semibold text-stone-700 dark:text-stone-300 mb-2">Subject</label>
                            <select id="subject"
                                class="w-full px-5 py-3 rounded-xl border border-stone-200 dark:border-stone-600 bg-stone-50 dark:bg-stone-900 focus:ring-2 focus:ring-agri-green outline-none transition-all">
                                <option>Product Inquiry</option>
                                <option>Bulk Order</option>
                                <option>Farming Advice</option>
                                <option>Other</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label for="message"
                            class="block text-sm font-semibold text-stone-700 dark:text-stone-300 mb-2">Message</label>
                        <textarea id="message" rows="4"
                            class="w-full px-5 py-3 rounded-xl border border-stone-200 dark:border-stone-600 bg-stone-50 dark:bg-stone-900 focus:ring-2 focus:ring-agri-green outline-none transition-all"
                            placeholder="How can we help you?"></textarea>
                    </div>
                    <button onclick="sendToWhatsApp()"
                        class="w-full bg-[#25D366] hover:bg-[#128C7E] text-white font-bold py-4 rounded-xl transition-all flex items-center justify-center gap-3 shadow-lg shadow-green-500/20">
                        <i data-lucide="message-circle" class="w-6 h-6"></i>
                        Contact on WhatsApp
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Farming Tips Section -->
    <section id="farming-tips"
        class="py-24 overflow-hidden border-t border-stone-100 dark:border-stone-800 bg-stone-50/50 dark:bg-stone-900/10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row justify-between items-end mb-12 gap-6">
                <div class="max-w-2xl">
                    <h2 class="text-4xl font-bold mb-4">Modern <span class="text-agri-green">Farming Tips</span></h2>
                    <p class="text-stone-500 dark:text-stone-400">Expert advice to help you maximize your harvest and
                        maintain a sustainable farm. Updated weekly by our agronomists.</p>
                </div>
                <button
                    class="bg-stone-100 dark:bg-stone-800 px-6 py-3 rounded-xl font-bold hover:bg-agri-green hover:text-white transition-all">View
                    All Tips</button>
            </div>

            <div class="grid md:grid-cols-3 gap-8">
                <!-- TipCard 1 -->
                <div onclick="openTipModal(1)"
                    class="group bg-white dark:bg-stone-900 p-8 rounded-[2.5rem] border border-stone-100 dark:border-stone-800 hover:border-agri-green transition-all duration-500 shadow-xl shadow-stone-200/50 dark:shadow-none cursor-pointer">
                    <div
                        class="w-14 h-14 bg-agri-light dark:bg-agri-green/20 rounded-2xl flex items-center justify-center text-agri-green mb-8 group-hover:scale-110 transition-transform">
                        <i data-lucide="cloud-rain" class="w-7 h-7"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-4 group-hover:text-agri-green transition-colors">Smart Irrigation
                    </h3>
                    <p class="text-stone-500 dark:text-stone-400 leading-relaxed mb-6">Learn how to optimize water usage
                        using capillary sensors and automated drip systems for efficient growth.</p>
                    <button class="inline-flex items-center gap-2 text-agri-green font-bold group">Read More <i
                            data-lucide="chevron-right"
                            class="w-4 h-4 group-hover:translate-x-1 transition-transform"></i></button>
                </div>
                <!-- TipCard 2 -->
                <div onclick="openTipModal(2)"
                    class="group bg-white dark:bg-stone-900 p-8 rounded-[2.5rem] border border-stone-100 dark:border-stone-800 hover:border-agri-green transition-all duration-500 shadow-xl shadow-stone-200/50 dark:shadow-none cursor-pointer">
                    <div
                        class="w-14 h-14 bg-agri-light dark:bg-agri-green/20 rounded-2xl flex items-center justify-center text-agri-green mb-8 group-hover:scale-110 transition-transform">
                        <i data-lucide="bug" class="w-7 h-7"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-4 group-hover:text-agri-green transition-colors">Organic Pest
                        Control</h3>
                    <p class="text-stone-500 dark:text-stone-400 leading-relaxed mb-6">Discover natural remedies and
                        companion planting techniques to keep your crops safe without harsh chemicals.</p>
                    <button class="inline-flex items-center gap-2 text-agri-green font-bold group">Read More <i
                            data-lucide="chevron-right"
                            class="w-4 h-4 group-hover:translate-x-1 transition-transform"></i></button>
                </div>
                <!-- TipCard 3 -->
                <div onclick="openTipModal(3)"
                    class="group bg-white dark:bg-stone-900 p-8 rounded-[2.5rem] border border-stone-100 dark:border-stone-800 hover:border-agri-green transition-all duration-500 shadow-xl shadow-stone-200/50 dark:shadow-none cursor-pointer">
                    <div
                        class="w-14 h-14 bg-agri-light dark:bg-agri-green/20 rounded-2xl flex items-center justify-center text-agri-green mb-8 group-hover:scale-110 transition-transform">
                        <i data-lucide="test-tube" class="w-7 h-7"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-4 group-hover:text-agri-green transition-colors">Soil Health 101
                    </h3>
                    <p class="text-stone-500 dark:text-stone-400 leading-relaxed mb-6">A guide to testing soil pH and
                        replenishing essential nutrients like Nitrogen, Phosphorus, and Potassium.</p>
                    <button class="inline-flex items-center gap-2 text-agri-green font-bold group">Read More <i
                            data-lucide="chevron-right"
                            class="w-4 h-4 group-hover:translate-x-1 transition-transform"></i></button>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-stone-900 dark:bg-black text-white py-16 border-t border-stone-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-3 gap-12 mb-12">
                <div class="space-y-4">
                    <div class="flex items-center gap-2">
                        <div class="bg-agri-green p-2 rounded-lg text-white">
                            <i data-lucide="leaf" class="w-6 h-6"></i>
                        </div>
                        <span class="text-2xl font-bold">AgriStore</span>
                    </div>
                    <p class="text-stone-400">Leading provider of premium agricultural inputs and modern farming
                        solutions.</p>
                </div>
                <div>
                    <h3 class="font-bold mb-6">Quick Links</h3>
                    <ul class="space-y-3 text-stone-400">
                        <li><a href="#" class="hover:text-agri-green transition-colors">Products</a></li>
                        <li><a href="#" class="hover:text-agri-green transition-colors">Bulk Orders</a></li>
                        <li><a href="#" class="hover:text-agri-green transition-colors">Farming Tips</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-bold mb-6">Contact</h3>
                    <ul class="space-y-3 text-stone-400">
                        <li>Email: support@agristore.com</li>
                        <li>Phone: +91 63607 60312</li>
                    </ul>
                </div>
            </div>
            <div class="pt-8 border-t border-stone-800 text-center text-stone-500">
                <p>© 2026 AgriStore. Designed for modern agriculture.</p>
            </div>
        </div>
    </footer>

    <!-- Toast Notification -->
    <div id="toast"
        class="fixed bottom-8 left-1/2 -translate-x-1/2 bg-stone-900 dark:bg-agri-green text-white px-6 py-3 rounded-full shadow-2xl z-[100] hidden transform translate-y-20 transition-all duration-300 flex items-center gap-3">
        <i data-lucide="check-circle" class="w-5 h-5 text-agri-green dark:text-white"></i>
        <span id="toast-msg">Added to cart</span>
    </div>

    <script>
        // Data
        const products = [
            {
                id: 1,
                name: "Organic Tomato Seeds",
                category: "Seeds",
                price: 150,
                image: "https://images.unsplash.com/photo-1592841200221-a6898f307baa?auto=format&fit=crop&q=80&w=800",
                description: "Vibrant and healthy organic tomato seeds, specifically bred for high yield and excellent disease resistance. Perfect for both garden beds and larger farming plots.",
                specs: { weight: "10g", brand: "AgriSeeds", usage: "Sunlight: 6-8 hrs" },
                rating: 4.5,
                reviews: 89
            },
            {
                id: 2,
                name: "Premium Soil Mix",
                category: "Fertilizer",
                price: 450,
                image: "https://images.unsplash.com/photo-1585320806297-9794b3e4eeae?auto=format&fit=crop&q=80&w=800",
                description: "Our signature blend of peat, compost, and essential minerals. This premium soil mix provides the perfect foundation for strong root development and nutrient uptake.",
                specs: { weight: "5kg", brand: "BhoomiPlus", usage: "All Plants" },
                rating: 4.9,
                reviews: 245
            },
            {
                id: 3,
                name: "Gardening Trowel",
                category: "Tools",
                price: 299,
                image: "https://images.unsplash.com/photo-1416872928419-dc4206935551?auto=format&fit=crop&q=80&w=800",
                description: "Professional grade stainless steel trowel. Features an ergonomic hardwood handle and measurement markings for precise planting depth.",
                specs: { weight: "300g", brand: "IronHand", usage: "Digging/Planting" },
                rating: 4.7,
                reviews: 56
            },
            {
                id: 4,
                name: "Natural Nitrogen Fertilizer",
                category: "Fertilizer",
                price: 899,
                image: "https://images.unsplash.com/photo-1628352081506-83c43123ed6d?auto=format&fit=crop&q=80&w=800",
                description: "A fast-acting, organic liquid fertilizer rich in nitrogen. Ideal for leafy greens and vegetables during their peak growth stages.",
                specs: { weight: "1L", brand: "GreenNitro", usage: "Liquid Application" },
                rating: 4.6,
                reviews: 112
            },
            {
                id: 5,
                name: "Basil Herb Seeds",
                category: "Seeds",
                price: 120,
                image: "https://images.unsplash.com/photo-1618160702438-9b02ab6515c9?auto=format&fit=crop&q=80&w=800",
                description: "Highly aromatic Genovese basil seeds. Easy to germinate and grows vigorously in sunlight. Perfect for culinary enthusiasts.",
                specs: { weight: "5g", brand: "AgriSeeds", usage: "Sunlight: 6 hrs" },
                rating: 4.8,
                reviews: 67
            },
            {
                id: 6,
                name: "Watering Can (5L)",
                category: "Tools",
                price: 550,
                image: "https://images.unsplash.com/photo-1536069221282-d877868cad6b?auto=format&fit=crop&q=80&w=800",
                description: "Balanced design with a long reach spout. Includes a brass rose head for gentle watering of small seedlings and delicate plants.",
                specs: { weight: "500g", brand: "EcoGrow", usage: "Outdoor/Indoor" },
                rating: 4.8,
                reviews: 124
            }
        ];

        const farmingTips = [
            {
                id: 1,
                title: "Smart Irrigation",
                icon: "cloud-rain",
                short: "Learn how to optimize water usage using capillary sensors and automated drip systems.",
                content: "Smart irrigation systems use technology to monitor soil moisture and weather conditions. By installing capillary sensors, you can ensure your plants receive exactly the amount of water they need, reducing waste and improving crop health. Drip systems deliver water directly to the roots, minimizing evaporation."
            },
            {
                id: 2,
                title: "Organic Pest Control",
                icon: "bug",
                short: "Discover natural remedies and companion planting techniques to keep your crops safe.",
                content: "Organic pest control focuses on natural solutions like neem oil, garlic sprays, and introducing beneficial insects like ladybugs. Companion planting—growing certain plants together (like marigolds with tomatoes)—can naturally repel pests without the need for synthetic chemicals."
            },
            {
                id: 3,
                title: "Soil Health 101",
                icon: "test-tube",
                short: "A guide to testing soil pH and replenishing essential nutrients like Nitrogen and Phosphorus.",
                content: "Healthy soil is the foundation of a good harvest. Regular pH testing helps you understand which nutrients are missing. Replenishing soil with organic compost, manure, or specific organic fertilizers ensures that Nitrogen, Phosphorus, and Potassium levels remain optimal for plant growth."
            }
        ];

        // State
        let currentCategory = 'All';
        let isDarkMode = localStorage.getItem('agri_theme') === 'dark';
        let currentUser = JSON.parse(localStorage.getItem('agri_current_user')) || null;
        let users = JSON.parse(localStorage.getItem('agri_users')) || [];
        let appliedDiscount = 0;

        // User Data
        let cart = [];
        let wishlist = [];
        let orders = [];

        function getStorageKey(baseKey, userId = null) {
            const id = userId || (currentUser ? currentUser.id : null);
            return id ? `${baseKey}_${id}` : baseKey;
        }

        function loadUserData() {
            const guestCart = JSON.parse(localStorage.getItem('agri_cart')) || [];
            const guestWishlist = JSON.parse(localStorage.getItem('agri_wishlist')) || [];

            cart = JSON.parse(localStorage.getItem(getStorageKey('agri_cart'))) || [];
            wishlist = JSON.parse(localStorage.getItem(getStorageKey('agri_wishlist'))) || [];
            orders = JSON.parse(localStorage.getItem(getStorageKey('agri_orders'))) || [];

            if (currentUser && (guestCart.length > 0 || guestWishlist.length > 0)) {
                // Merge guest cart
                guestCart.forEach(gItem => {
                    const existing = cart.find(uItem => uItem.id === gItem.id);
                    if (existing) existing.quantity += gItem.quantity;
                    else cart.push(gItem);
                });
                // Merge guest wishlist
                guestWishlist.forEach(id => {
                    if (!wishlist.includes(id)) wishlist.push(id);
                });

                // Save merged results
                saveCart();
                localStorage.setItem(getStorageKey('agri_wishlist'), JSON.stringify(wishlist));

                // Clear guest data
                localStorage.removeItem('agri_cart');
                localStorage.removeItem('agri_wishlist');
                localStorage.removeItem('agri_orders');
            }
        }

        function saveCart() {
            localStorage.setItem(getStorageKey('agri_cart'), JSON.stringify(cart));
        }

        function saveWishlist() {
            localStorage.setItem(getStorageKey('agri_wishlist'), JSON.stringify(wishlist));
        }

        function saveOrders() {
            localStorage.setItem(getStorageKey('agri_orders'), JSON.stringify(orders));
        }

        // Init
        window.onload = () => {
            loadUserData();
            applyInitialTheme();
            updateCartUI();
            updateAuthUI();
            renderProducts(products);
            lucide.createIcons();
        };

        // Auth Logic
        function openAuthModal() {
            const modal = document.getElementById('auth-modal');
            modal.classList.remove('hidden');
            setTimeout(() => modal.classList.remove('opacity-0'), 10);
            document.body.classList.add('cart-open');
        }

        function closeAuthModal() {
            const modal = document.getElementById('auth-modal');
            modal.classList.add('opacity-0');
            setTimeout(() => modal.classList.add('hidden'), 300);
            document.body.classList.remove('cart-open');
        }

        function toggleAuthMode(mode) {
            const loginForm = document.getElementById('login-form');
            const signupForm = document.getElementById('signup-form');
            if (mode === 'signup') {
                loginForm.classList.add('hidden');
                signupForm.classList.remove('hidden');
            } else {
                loginForm.classList.remove('hidden');
                signupForm.classList.add('hidden');
            }
        }

        function handleSignup() {
            const name = document.getElementById('signup-name').value;
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;

            if (!name || !email || !password) {
                showToast("Please fill all fields", true);
                return;
            }

            if (users.find(u => u.email === email)) {
                showToast("Email already exists", true);
                return;
            }

            const newUser = { name, email, password, id: Date.now() };
            users.push(newUser);
            localStorage.setItem('agri_users', JSON.stringify(users));

            currentUser = newUser;
            localStorage.setItem('agri_current_user', JSON.stringify(currentUser));

            loadUserData();
            updateAuthUI();
            updateCartUI();
            renderProducts(products); // Refresh to show wishlist status
            closeAuthModal();
            showToast(`Welcome, ${name}!`);
        }

        function handleLogin() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;

            const user = users.find(u => u.email === email && u.password === password);
            if (user) {
                currentUser = user;
                localStorage.setItem('agri_current_user', JSON.stringify(currentUser));
                loadUserData();
                updateAuthUI();
                updateCartUI();
                renderProducts(products); // Refresh to show wishlist status
                closeAuthModal();
                showToast(`Welcome back, ${user.name}!`);
            } else {
                showToast("Invalid credentials", true);
            }
        }

        function handleLogout() {
            currentUser = null;
            localStorage.removeItem('agri_current_user');
            loadUserData();
            updateAuthUI();
            updateCartUI();
            renderProducts(products); // Refresh to clear wishlist status
            showToast("Logged out successfully");
        }

        function updateAuthUI() {
            const loginBtn = document.getElementById('login-btn');
            const userProfile = document.getElementById('user-profile');
            const avatarChar = document.getElementById('user-avatar-char');
            const nameDisplay = document.getElementById('user-name-display');

            if (currentUser) {
                loginBtn.classList.add('hidden');
                userProfile.classList.remove('hidden');
                avatarChar.innerText = currentUser.name.charAt(0).toUpperCase();
                nameDisplay.innerText = currentUser.name;
            } else {
                loginBtn.classList.remove('hidden');
                userProfile.classList.add('hidden');
            }
            lucide.createIcons();
        }

        // Theme
        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            document.documentElement.classList.toggle('dark', isDarkMode);
            localStorage.setItem('agri_theme', isDarkMode ? 'dark' : 'light');
            updateDarkModeIcon();
        }

        function applyInitialTheme() {
            if (isDarkMode) {
                document.documentElement.classList.add('dark');
            }
            updateDarkModeIcon();
        }

        function updateDarkModeIcon() {
            const icon = document.getElementById('dark-mode-icon');
            icon.setAttribute('data-lucide', isDarkMode ? 'sun' : 'moon');
            lucide.createIcons();
        }

        // Wishlist & Orders Modals (Simulated)
        function openWishlistModal() {
            showToast("Wishlist features coming in next update!", false);
        }

        function openOrdersModal() {
            showToast("Order history feature coming in next update!", false);
        }

        function toggleWishlist(productId) {
            const index = wishlist.indexOf(productId);
            if (index > -1) {
                wishlist.splice(index, 1);
                showToast("Removed from wishlist");
            } else {
                wishlist.push(productId);
                showToast("Added to wishlist");
            }
            saveWishlist();
            renderProducts(products);
        }

        // Coupon Logic
        function applyCoupon() {
            const code = document.getElementById('coupon-input').value.trim().toUpperCase();
            const msgEl = document.getElementById('coupon-msg');

            if (code === 'AGRI10') {
                appliedDiscount = 10;
                msgEl.innerText = "Coupon AGRI10 applied! 10% discount added.";
                msgEl.className = "text-xs mb-4 text-agri-green block";
            } else if (code === 'SUMMER20') {
                appliedDiscount = 20;
                msgEl.innerText = "Coupon SUMMER20 applied! 20% discount added.";
                msgEl.className = "text-xs mb-4 text-agri-green block";
            } else {
                appliedDiscount = 0;
                msgEl.innerText = "Invalid coupon code";
                msgEl.className = "text-xs mb-4 text-red-500 block";
            }
            updateCheckoutTotal();
        }

        function updateCheckoutTotal() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const discountAmount = (subtotal * appliedDiscount) / 100;
            const finalTotal = subtotal - discountAmount;
            document.getElementById('checkout-total').innerText = `₹${finalTotal}`;
        }

        // Farming Tips Logic
        function openTipModal(tipId) {
            const tip = farmingTips.find(t => t.id === tipId);
            if (!tip) return;

            document.getElementById('tip-modal-title').innerText = tip.title;
            document.getElementById('tip-modal-content').innerText = tip.content;
            document.getElementById('tip-modal-icon').innerHTML = `<i data-lucide="${tip.icon}" class="w-10 h-10"></i>`;

            const modal = document.getElementById('tip-modal');
            modal.classList.remove('hidden');
            setTimeout(() => modal.classList.remove('opacity-0'), 10);
            document.body.classList.add('cart-open');
            lucide.createIcons();
        }

        function closeTipModal() {
            const modal = document.getElementById('tip-modal');
            modal.classList.add('opacity-0');
            setTimeout(() => modal.classList.add('hidden'), 300);
            document.body.classList.remove('cart-open');
        }

        // Filtering
        function setCategory(cat) {
            currentCategory = cat;
            document.querySelectorAll('.category-btn').forEach(btn => {
                if (btn.innerText === cat) {
                    btn.classList.add('bg-agri-green', 'text-white', 'border-transparent');
                    btn.classList.remove('border-stone-200', 'dark:border-stone-700');
                } else {
                    btn.classList.remove('bg-agri-green', 'text-white', 'border-transparent');
                    btn.classList.add('border-stone-200', 'dark:border-stone-700');
                }
            });
            handleFilter();
        }

        function handleFilter() {
            const query = document.getElementById('search-input').value.toLowerCase();
            const filtered = products.filter(p => {
                const matchesSearch = p.name.toLowerCase().includes(query) || p.description.toLowerCase().includes(query);
                const matchesCategory = currentCategory === 'All' || p.category === currentCategory;
                return matchesSearch && matchesCategory;
            });
            renderProducts(filtered);
        }

        // Rendering
        function renderProducts(items) {
            const grid = document.getElementById('product-grid');
            const noResults = document.getElementById('no-results');
            grid.innerHTML = '';

            if (items.length === 0) {
                noResults.classList.remove('hidden');
                return;
            }
            noResults.classList.add('hidden');

            items.forEach((p, idx) => {
                const card = document.createElement('div');
                card.className = `bg-white dark:bg-stone-800 rounded-3xl overflow-hidden shadow-sm hover:shadow-xl transition-all duration-500 border border-stone-100 dark:border-stone-700 group cursor-pointer animate-fade-in-up`;
                card.style.animationDelay = `${idx * 0.1}s`;
                card.onclick = () => openModal(p);

                const isInWishlist = wishlist.find(id => id === p.id);

                card.innerHTML = `
                    <div class="relative h-72 overflow-hidden">
                        <img src="${p.image}" alt="${p.name}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700" />
                        <div class="absolute top-4 left-4 bg-white/90 dark:bg-stone-900/90 backdrop-blur-md text-stone-800 dark:text-stone-200 text-xs font-bold px-3 py-1.5 rounded-full shadow-sm">
                            ${p.category}
                        </div>
                        <button onclick="event.stopPropagation(); toggleWishlist(${p.id})" 
                            class="absolute top-4 right-4 p-2 bg-white/90 dark:bg-stone-900/90 backdrop-blur-md rounded-full shadow-sm hover:scale-110 transition-all ${isInWishlist ? 'text-red-500' : 'text-stone-400'}">
                            <i data-lucide="heart" class="w-5 h-5 ${isInWishlist ? 'fill-current' : ''}"></i>
                        </button>
                        <div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2">
                             <button onclick="event.stopPropagation(); buyNow(${p.id})" class="bg-white text-stone-900 px-4 py-2 rounded-lg font-bold text-sm hover:bg-agri-green hover:text-white transition-all transform translate-y-4 group-hover:translate-y-0 duration-300">
                                Buy Now
                             </button>
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-stone-900 dark:text-white mb-2 group-hover:text-agri-green transition-colors">${p.name}</h3>
                        <p class="text-stone-500 dark:text-stone-400 text-sm line-clamp-2 mb-6">${p.description}</p>
                        <div class="flex items-center justify-between mt-auto">
                            <span class="text-2xl font-bold text-agri-green">₹${p.price}</span>
                            <button onclick="event.stopPropagation(); addToCart(${p.id})" class="flex items-center gap-2 bg-stone-900 dark:bg-white text-white dark:text-stone-900 px-5 py-2.5 rounded-xl text-sm font-bold transition-all active:scale-95 group-hover:bg-agri-green group-hover:text-white">
                                <i data-lucide="shopping-cart" class="w-4 h-4"></i> Add
                            </button>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
            lucide.createIcons();
        }

        // Modal Logic
        function openModal(p) {
            document.getElementById('modal-img').src = p.image;
            document.getElementById('modal-name').innerText = p.name;
            document.getElementById('modal-desc').innerText = p.description;
            document.getElementById('modal-price').innerText = `₹${p.price}`;
            document.getElementById('modal-category').innerText = p.category;

            // Rating and Specs
            document.getElementById('modal-rating').innerText = `${p.rating} (${p.reviews} reviews)`;
            document.getElementById('spec-weight').innerText = p.specs.weight;
            document.getElementById('spec-brand').innerText = p.specs.brand;
            document.getElementById('spec-usage').innerText = p.specs.usage;

            const addBtn = document.getElementById('modal-add-btn');
            addBtn.onclick = () => {
                addToCart(p.id);
                closeModal();
            };

            // Add Buy Now to Modal if missing
            let existingBuyBtn = document.getElementById('modal-buy-btn');
            if (!existingBuyBtn) {
                existingBuyBtn = document.createElement('button');
                existingBuyBtn.id = 'modal-buy-btn';
                existingBuyBtn.className = "ml-4 bg-white dark:bg-stone-800 border-2 border-agri-green text-agri-green hover:bg-agri-green hover:text-white px-8 py-3 rounded-xl font-bold transition-all";
                existingBuyBtn.innerText = "Buy Now";
                document.getElementById('modal-add-btn').parentElement.appendChild(existingBuyBtn);
            }
            existingBuyBtn.onclick = () => buyNow(p.id);

            const modal = document.getElementById('product-modal');
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.remove('opacity-0');
            }, 10);
            document.body.classList.add('cart-open');
            lucide.createIcons();
        }

        function closeModal() {
            const modal = document.getElementById('product-modal');
            modal.classList.add('opacity-0');
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
            document.body.classList.remove('cart-open');
        }

        // Cart Logic
        function toggleCart() {
            const sidebar = document.getElementById('cart-sidebar');
            const overlay = document.getElementById('cart-overlay');
            const isOpen = !sidebar.classList.contains('translate-x-full');

            if (isOpen) {
                sidebar.classList.add('translate-x-full');
                overlay.classList.add('opacity-0');
                setTimeout(() => overlay.classList.add('hidden'), 300);
                document.body.classList.remove('cart-open');
            } else {
                sidebar.classList.remove('translate-x-full');
                overlay.classList.remove('hidden');
                setTimeout(() => overlay.classList.remove('opacity-0'), 10);
                document.body.classList.add('cart-open');
                updateCartUI();
            }
        }

        function addToCart(productId) {
            const p = products.find(x => x.id === productId);
            const exists = cart.find(item => item.id === productId);

            if (exists) {
                exists.quantity += 1;
            } else {
                cart.push({ ...p, quantity: 1 });
            }

            saveCart();
            showToast(`Added ${p.name} to cart`);
            updateCartUI();
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            saveCart();
            updateCartUI();
        }

        function updateQuantity(productId, delta) {
            const item = cart.find(x => x.id === productId);
            if (item) {
                item.quantity += delta;
                if (item.quantity <= 0) {
                    removeFromCart(productId);
                } else {
                    saveCart();
                    updateCartUI();
                }
            }
        }


        function updateCartUI() {
            const itemsContainer = document.getElementById('cart-items');
            const emptyMsg = document.getElementById('empty-cart-msg');
            const badge = document.getElementById('cart-badge');
            const totalDisplay = document.getElementById('cart-total');

            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);

            badge.innerText = count;
            badge.classList.toggle('hidden', count === 0);
            totalDisplay.innerText = `₹${total}`;

            if (cart.length === 0) {
                emptyMsg.classList.remove('hidden');
                itemsContainer.querySelectorAll('.cart-item-row').forEach(el => el.remove());
            } else {
                emptyMsg.classList.add('hidden');
                itemsContainer.querySelectorAll('.cart-item-row').forEach(el => el.remove());

                cart.forEach(item => {
                    const row = document.createElement('div');
                    row.className = 'cart-item-row flex gap-4 bg-stone-50 dark:bg-stone-800/50 p-4 rounded-2xl border border-stone-100 dark:border-stone-700';
                    row.innerHTML = `
                        <img src="${item.image}" class="w-16 h-16 rounded-lg object-cover" />
                        <div class="flex-1">
                            <h4 class="font-bold text-sm">${item.name}</h4>
                            <p class="text-agri-green font-bold text-sm">₹${item.price}</p>
                            <div class="flex items-center gap-3 mt-2">
                                <button onclick="updateQuantity(${item.id}, -1)" class="w-6 h-6 border dark:border-stone-600 rounded flex items-center justify-center hover:bg-stone-200 dark:hover:bg-stone-700">-</button>
                                <span class="text-xs font-bold">${item.quantity}</span>
                                <button onclick="updateQuantity(${item.id}, 1)" class="w-6 h-6 border dark:border-stone-600 rounded flex items-center justify-center hover:bg-stone-200 dark:hover:bg-stone-700">+</button>
                            </div>
                        </div>
                        <button onclick="removeFromCart(${item.id})" class="text-stone-400 hover:text-red-500 transition-colors">
                            <i data-lucide="trash-2" class="w-5 h-5"></i>
                        </button>
                    `;
                    itemsContainer.appendChild(row);
                });
            }
            lucide.createIcons();
        }

        // WhatsApp Logic
        function sendToWhatsApp() {
            const name = document.getElementById('name').value;
            const message = document.getElementById('message').value;
            const subject = document.getElementById('subject').value;
            const phoneNumber = "916360760312";

            if (!name || !message) {
                showToast("Please fill in required fields", true);
                return;
            }

            const text = `*New Inquiry from AgriStore*\n\n*Name:* ${name}\n*Subject:* ${subject}\n*Message:* ${message}`;
            const url = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(text)}`;
            window.open(url, '_blank');
        }

        // Checkout Logic
        function openCheckout() {
            if (cart.length === 0) {
                showToast("Your cart is empty!", true);
                return;
            }
            const modal = document.getElementById('checkout-modal');
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            document.getElementById('checkout-total').innerText = `₹${total}`;

            modal.classList.remove('hidden');
            setTimeout(() => modal.classList.remove('opacity-0'), 10);
            document.body.classList.add('cart-open');
        }

        function closeCheckout() {
            const modal = document.getElementById('checkout-modal');
            modal.classList.add('opacity-0');
            setTimeout(() => modal.classList.add('hidden'), 300);
            document.body.classList.remove('cart-open');
        }

        function confirmOrder() {
            const name = document.getElementById('checkout-name').value;
            const phone = document.getElementById('checkout-phone').value;
            const address = document.getElementById('checkout-address').value;

            if (!name || !phone || !address) {
                alert("Please fill in all checkout details!");
                return;
            }

            let orderDetails = `*🚀 New Order from AgriStore*\n\n`;
            orderDetails += `*👤 Customer:* ${name}\n`;
            orderDetails += `*📞 Phone:* ${phone}\n`;
            orderDetails += `*📍 Address:* ${address}\n\n`;
            orderDetails += `*📦 Items:*\n`;

            cart.forEach(item => {
                orderDetails += `- ${item.name} (x${item.quantity}) - ₹${item.price * item.quantity}\n`;
            });

            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const discountAmount = (subtotal * appliedDiscount) / 100;
            const finalTotal = subtotal - discountAmount;

            if (appliedDiscount > 0) {
                orderDetails += `\n*💰 Subtotal:* ₹${subtotal}`;
                orderDetails += `\n*🎁 Discount (${appliedDiscount}%):* -₹${discountAmount}`;
            }
            orderDetails += `\n*✅ Final Total:* ₹${finalTotal}`;

            const url = `https://wa.me/916360760312?text=${encodeURIComponent(orderDetails)}`;
            window.open(url, '_blank');

            // Success cleanup
            const orderRecord = {
                id: Date.now(),
                items: [...cart],
                total: finalTotal,
                date: new Date().toISOString()
            };
            orders.push(orderRecord);
            saveOrders();

            cart = [];
            saveCart();
            updateCartUI();
            closeCheckout();
            if (!document.getElementById('cart-sidebar').classList.contains('translate-x-full')) toggleCart();
            showToast("Order sent successfully!");
        }

        function checkout() { // This triggers from the Sidebar
            openCheckout();
        }

        function buyNow(productId) {
            const existsInCart = cart.find(item => item.id === productId);
            if (!existsInCart) {
                const p = products.find(x => x.id === productId);
                cart.push({ ...p, quantity: 1 });
                saveCart();
                updateCartUI();
            }
            closeModal();
            openCheckout();
        }

        function showToast(msg, isError = false) {
            const toast = document.getElementById('toast');
            const msgEl = document.getElementById('toast-msg');
            msgEl.innerText = msg;

            toast.classList.remove('hidden', 'translate-y-20');
            setTimeout(() => {
                toast.classList.add('translate-y-20');
                setTimeout(() => toast.classList.add('hidden'), 300);
            }, 3000);
        }
    </script>
</body>

</html>